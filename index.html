<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Porta amici a Wall Street English e vinci premi! 1 amico = Trolley, 2 amici = 3 mesi gratis!" />
  <meta property="og:title" content="Wall Street English - Programma Referral Febbraio 2026" />
  <meta property="og:description" content="Pi√π amici porti, pi√π vinci! 1 amico = Trolley, 2 amici = 3 mesi gratis! üéÅ" />
  <title>Wall Street English - Referral Febbraio 2026</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root{
      --wse-red:#f12c3e;
      --wse-blue:#003359;
      --wse-light-blue:#0A5A8A;
      --wse-gold:#FFD700;
      --text-dark:#1a1a1a;
      --text-gray:#666;
      --bg-light:#f8f9fa;
      --white:#fff;
    }

    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      background:linear-gradient(135deg,var(--wse-blue) 0%,var(--wse-light-blue) 100%);
      min-height:100vh;
      padding:0;
    }

    .container{
      max-width:600px;
      margin:0 auto;
      background:var(--white);
      min-height:100vh;
      box-shadow:0 0 50px rgba(0,0,0,.2);
    }

    /* Header */
    .header{
      background:var(--white);
      padding:22px 20px;
      text-align:center;
      box-shadow:0 2px 10px rgba(0,0,0,.1);
      position:sticky;
      top:0;
      z-index:100;
    }

    .logo{
      display:block;
      margin:0 auto 12px;
      height:54px;          /* controlla qui la dimensione */
      width:auto;
      max-width:240px;
      object-fit:contain;
    }

    .badge{
      background:linear-gradient(135deg,var(--wse-red) 0%,#c91219 100%);
      color:var(--white);
      display:inline-block;
      padding:8px 25px;
      border-radius:999px;
      font-size:14px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:1px;
      box-shadow:0 4px 15px rgba(241,44,62,.3);
    }

    /* Hero */
    .hero{
      background:linear-gradient(135deg,var(--wse-blue) 0%,var(--wse-light-blue) 100%);
      color:var(--white);
      padding:38px 20px;
      text-align:center;
    }

    .hero-emoji{ font-size:56px; margin-bottom:16px; }
    .hero-title{ font-size:28px; font-weight:900; margin-bottom:12px; line-height:1.2; }
    .hero-subtitle{ font-size:17px; opacity:.95; margin-bottom:10px; }

    .hero-highlight{
      background:rgba(255,215,0,.18);
      border:2px solid var(--wse-gold);
      border-radius:12px;
      padding:12px 14px;
      margin:18px auto 0;
      max-width:420px;
      font-size:15px;
      font-weight:700;
    }

    /* Rewards */
    .rewards-section{ padding:28px 20px; background:var(--bg-light); }
    .section-title{
      color:var(--wse-blue);
      font-size:22px;
      font-weight:900;
      text-align:center;
      margin-bottom:22px;
    }

    .rewards-grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      max-width:520px;
      margin:0 auto;
    }

    .reward-card{
      background:var(--white);
      border-radius:16px;
      padding:22px 18px;
      text-align:center;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
      position:relative;
      overflow:hidden;
    }

    .reward-card::before{
      content:"";
      position:absolute;
      top:0; left:0; right:0;
      height:5px;
      background:linear-gradient(90deg,var(--wse-red),var(--wse-gold));
    }

    .reward-level{
      background:var(--wse-red);
      color:var(--white);
      display:inline-block;
      padding:6px 14px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      margin-bottom:12px;
      letter-spacing:.6px;
      text-transform:uppercase;
    }

    .reward-card.premium .reward-level{
      background:linear-gradient(135deg,var(--wse-gold),#FFA500);
      color:var(--text-dark);
    }

    .reward-icon{ font-size:48px; margin-bottom:12px; }
    .reward-title{ color:var(--wse-blue); font-size:17px; font-weight:900; margin-bottom:6px; }
    .reward-description{ color:var(--text-gray); font-size:13.5px; line-height:1.45; }

    /* Progress */
    .friend-counter-section{
      background:linear-gradient(135deg,#fff5f5 0%,#fff 100%);
      padding:28px 20px;
      border-top:3px solid var(--wse-red);
      border-bottom:3px solid var(--wse-red);
    }

    .counter-title{
      color:var(--wse-blue);
      font-size:20px;
      font-weight:900;
      text-align:center;
      margin-bottom:16px;
    }

    .counter-display{
      background:var(--white);
      border:3px solid var(--wse-red);
      border-radius:16px;
      padding:20px;
      text-align:center;
      max-width:420px;
      margin:0 auto 18px;
      box-shadow:0 4px 12px rgba(241,44,62,.15);
    }

    .counter-number{ font-size:64px; font-weight:900; color:var(--wse-red); line-height:1; margin-bottom:8px; }
    .counter-label{ color:var(--text-gray); font-size:15px; font-weight:700; }

    .progress-rewards{ max-width:420px; margin:0 auto; }

    .reward-checkpoint{
      display:flex;
      align-items:center;
      gap:12px;
      padding:14px;
      background:var(--white);
      border-radius:12px;
      margin-bottom:10px;
      border:2px solid #e0e0e0;
    }

    .reward-checkpoint.achieved{
      border-color:var(--wse-gold);
      background:linear-gradient(135deg,#fff9e6 0%,#fff 100%);
    }

    .checkpoint-icon{
      width:48px;
      height:48px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
      background:#f0f0f0;
      flex-shrink:0;
    }

    .reward-checkpoint.achieved .checkpoint-icon{
      background:linear-gradient(135deg,var(--wse-gold),#FFA500);
    }

    .checkpoint-number{ color:var(--wse-red); font-size:12.5px; font-weight:900; margin-bottom:2px; }
    .checkpoint-prize{ color:var(--text-dark); font-size:15px; font-weight:800; }
    .checkpoint-status{ font-size:18px; }

    /* Steps */
    .steps-section{ padding:28px 20px; background:var(--white); }

    .step{
      background:var(--white);
      border:3px solid var(--bg-light);
      border-radius:16px;
      padding:18px;
      margin-bottom:14px;
      position:relative;
      overflow:hidden;
    }

    .step::before{
      content:"";
      position:absolute;
      left:0; top:0;
      width:6px; height:100%;
      background:var(--wse-red);
    }

    .step-header{ display:flex; align-items:center; gap:12px; margin-bottom:10px; }
    .step-number{
      width:44px; height:44px;
      background:linear-gradient(135deg,var(--wse-red) 0%,#c91219 100%);
      color:var(--white);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      font-weight:900;
      flex-shrink:0;
    }
    .step-title{ color:var(--text-dark); font-size:17px; font-weight:900; }
    .step-description{ color:var(--text-gray); font-size:14.5px; line-height:1.5; padding-left:56px; }

    /* CTA */
    .cta-section{ background:var(--bg-light); padding:28px 20px; text-align:center; }
    .cta-title{ color:var(--wse-blue); font-size:22px; font-weight:900; margin-bottom:10px; }
    .cta-subtitle{ color:var(--text-gray); font-size:15px; margin-bottom:18px; }

    .cta-button{
      background:linear-gradient(135deg,var(--wse-red) 0%,#c91219 100%);
      color:var(--white);
      border:none;
      padding:16px 26px;
      border-radius:999px;
      font-size:16px;
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:1px;
      cursor:pointer;
      box-shadow:0 8px 24px rgba(241,44,62,.35);
      width:100%;
      max-width:360px;
    }

    /* Requirements */
    .requirements{ background:var(--wse-blue); color:var(--white); padding:26px 20px; text-align:center; }
    .requirements-title{ font-size:20px; font-weight:900; margin-bottom:16px; }
    .requirements-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
      gap:12px;
      max-width:520px;
      margin:0 auto;
    }

    .requirement-item{
      background:rgba(255,255,255,.14);
      padding:16px 12px;
      border-radius:12px;
      border:2px solid rgba(241,44,62,.28);
    }
    .requirement-icon{ font-size:28px; margin-bottom:6px; }
    .requirement-text{ font-size:13.5px; font-weight:800; line-height:1.35; }

    /* Share */
    .share-section{ background:var(--bg-light); padding:26px 20px; text-align:center; }
    .share-title{ color:var(--wse-blue); font-size:20px; font-weight:900; margin-bottom:10px; }
    .share-text{ color:var(--text-gray); font-size:14.5px; margin-bottom:18px; }

    .share-buttons{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
    .share-btn{
      display:flex;
      align-items:center;
      gap:8px;
      padding:12px 18px;
      border-radius:999px;
      font-size:14.5px;
      font-weight:900;
      border:none;
      cursor:pointer;
      color:var(--white);
    }
    .share-btn.whatsapp{ background:#25D366; }
    .share-btn.instagram{ background:linear-gradient(135deg,#833AB4 0%,#FD1D1D 50%,#FCB045 100%); }
    .share-btn.tiktok{ background:#000; }
    .share-btn.copy{ background:var(--wse-blue); }

    /* Footer */
    .footer{ background:var(--text-dark); color:var(--white); padding:20px; text-align:center; }
    .footer-text{ font-size:12px; opacity:.75; line-height:1.6; }

    /* Modal */
    .modal{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.8);
      z-index:1000;
      overflow-y:auto;
      -webkit-overflow-scrolling:touch;
    }

    .modal.active{
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:18px;
    }

    .modal-content{
      background:var(--white);
      border-radius:20px;
      width:100%;
      max-width:520px;
      margin:18px auto;
      position:relative;
      animation:slideUp .25s ease;
    }

    @keyframes slideUp{
      from{ opacity:0; transform:translateY(28px); }
      to{ opacity:1; transform:translateY(0); }
    }

    .modal-header{
      background:var(--wse-blue);
      color:var(--white);
      padding:22px 20px;
      border-radius:20px 20px 0 0;
      text-align:center;
      position:relative;
    }

    .close-btn{
      position:absolute;
      top:12px;
      right:12px;
      background:rgba(255,255,255,.18);
      border:none;
      color:var(--white);
      font-size:26px;
      width:40px;
      height:40px;
      border-radius:50%;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .modal-title{ font-size:20px; font-weight:900; margin-bottom:6px; }
    .modal-subtitle{ font-size:14px; opacity:.9; }

    .form-body{ padding:22px 20px; }

    .form-step{ display:none; }
    .form-step.active{ display:block; animation:fadeIn .2s ease; }

    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

    .form-group{ margin-bottom:16px; }

    .form-label{
      display:block;
      color:var(--text-dark);
      font-size:14px;
      font-weight:800;
      margin-bottom:8px;
    }

    .form-input{
      width:100%;
      padding:13px 14px;
      border:2px solid #e0e0e0;
      border-radius:12px;
      font-size:16px;
      font-family:inherit;
    }

    .form-input:focus{
      outline:none;
      border-color:var(--wse-red);
      box-shadow:0 0 0 3px rgba(241,44,62,.12);
    }

    .friend-entry{
      background:var(--bg-light);
      border-radius:12px;
      padding:16px;
      margin-bottom:14px;
      border:2px solid #e0e0e0;
    }

    .friend-entry-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:12px;
      gap:10px;
    }

    .friend-entry-title{
      color:var(--wse-blue);
      font-size:14px;
      font-weight:900;
    }

    .remove-friend-btn{
      background:transparent;
      border:2px solid var(--wse-red);
      color:var(--wse-red);
      padding:6px 10px;
      border-radius:999px;
      font-size:12.5px;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }

    .add-friend-btn{
      background:var(--white);
      border:2px dashed var(--wse-blue);
      color:var(--wse-blue);
      padding:14px;
      border-radius:12px;
      font-size:15px;
      font-weight:900;
      cursor:pointer;
      width:100%;
      margin:6px 0 16px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }

    .checkbox-wrapper{
      display:flex;
      align-items:flex-start;
      gap:10px;
      margin-bottom:12px;
      padding:12px;
      background:var(--bg-light);
      border-radius:12px;
    }

    .checkbox-input{
      width:20px;
      height:20px;
      margin-top:2px;
      cursor:pointer;
      accent-color:var(--wse-red);
    }

    .checkbox-label{
      color:var(--text-gray);
      font-size:12.8px;
      line-height:1.45;
      cursor:pointer;
      flex:1;
    }

    .btn{
      background:linear-gradient(135deg,var(--wse-red) 0%,#c91219 100%);
      color:var(--white);
      border:none;
      padding:14px 20px;
      border-radius:999px;
      font-size:15px;
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:1px;
      cursor:pointer;
      box-shadow:0 6px 18px rgba(241,44,62,.28);
      width:100%;
    }

    .btn:disabled{ background:#ccc; box-shadow:none; cursor:not-allowed; }

    .btn-secondary{
      background:var(--white);
      color:var(--wse-red);
      border:2px solid var(--wse-red);
      margin-top:10px;
      box-shadow:none;
    }

    .info-box{
      background:#fff5f5;
      border-left:4px solid var(--wse-red);
      padding:12px;
      border-radius:10px;
      margin:14px 0;
    }

    .info-box-title{ color:var(--wse-red); font-size:13px; font-weight:900; margin-bottom:6px; }
    .info-box-text{ color:var(--text-gray); font-size:12.8px; line-height:1.45; }

    /* Success */
    .success-screen{ text-align:center; padding:26px 18px; }

    .success-icon{
      width:76px;
      height:76px;
      background:var(--wse-red);
      color:var(--white);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:38px;
      margin:0 auto 16px;
      box-shadow:0 8px 24px rgba(241,44,62,.28);
    }

    .success-title{ color:var(--text-dark); font-size:22px; font-weight:900; margin-bottom:10px; }
    .success-text{ color:var(--text-gray); font-size:15px; line-height:1.55; margin-bottom:14px; }

    .success-rewards{
      background:linear-gradient(135deg,#fff9e6 0%,#fff 100%);
      border:3px solid var(--wse-gold);
      border-radius:16px;
      padding:14px;
      margin-bottom:14px;
      text-align:left;
    }

    .success-rewards-title{ color:var(--wse-blue); font-size:16px; font-weight:900; margin-bottom:10px; text-align:center; }

    .success-reward-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px;
      background:var(--white);
      border-radius:10px;
      margin-bottom:10px;
    }
    .success-reward-item:last-child{ margin-bottom:0; }
    .success-reward-icon{ font-size:24px; }
    .success-reward-text{ color:var(--text-dark); font-size:14.5px; font-weight:800; }

    /* Loading */
    .spinner{
      border:3px solid #f3f3f3;
      border-top:3px solid var(--wse-red);
      border-radius:50%;
      width:40px;
      height:40px;
      animation:spin 1s linear infinite;
      margin:20px auto;
    }
    @keyframes spin{ 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

    @media (max-width:480px){
      .rewards-grid{ grid-template-columns:1fr; }
      .hero-title{ font-size:24px; }
      .share-buttons{ flex-direction:column; }
      .share-btn{ width:100%; justify-content:center; }
      .counter-number{ font-size:56px; }
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- Header -->
    <div class="header">
      <!-- Logo esterno: deve esistere nel repo con questo nome -->
      <img
        class="logo"
        src="wse-logo-82302e12428034dac110b9c59931c993-2.svg"
        alt="Wall Street English"
        loading="eager"
      />
      <div class="badge">Febbraio 2026</div>
    </div>

    <!-- Hero -->
    <div class="hero">
      <div class="hero-emoji">üéØ</div>
      <h1 class="hero-title">Pi√π Amici Porti,<br>Pi√π Vinci!</h1>
      <p class="hero-subtitle">Programma Referral con premi progressivi</p>
      <div class="hero-highlight">‚≠ê 1 Amico = Trolley | 2 Amici = 3 Mesi Gratis! ‚≠ê</div>
    </div>

    <!-- Rewards -->
    <div class="rewards-section">
      <h2 class="section-title">I Tuoi Premi</h2>
      <div class="rewards-grid">
        <div class="reward-card">
          <span class="reward-level">Livello 1</span>
          <div class="reward-icon">üß≥</div>
          <h3 class="reward-title">Trolley Esclusivo</h3>
          <p class="reward-description">Porta 1 amico e ricevi subito il trolley Wall Street English</p>
        </div>

        <div class="reward-card premium">
          <span class="reward-level">Livello 2</span>
          <div class="reward-icon">üèÜ</div>
          <h3 class="reward-title">3 Mesi Gratis!</h3>
          <p class="reward-description">Porta 2 amici e ottieni 3 mesi di corso completamente gratuiti</p>
        </div>
      </div>
    </div>

    <!-- Progress -->
    <div class="friend-counter-section">
      <h3 class="counter-title">Amici che stai inserendo</h3>
      <div class="counter-display">
        <div class="counter-number" id="friendCountDisplay">1</div>
        <div class="counter-label">Amici nel Form</div>
      </div>

      <div class="progress-rewards">
        <div class="reward-checkpoint achieved" id="checkpoint1">
          <div class="checkpoint-icon">üß≥</div>
          <div class="checkpoint-info">
            <div class="checkpoint-number">1¬∞ Amico</div>
            <div class="checkpoint-prize">Trolley Esclusivo</div>
          </div>
          <span class="checkpoint-status">‚úì</span>
        </div>

        <div class="reward-checkpoint" id="checkpoint2">
          <div class="checkpoint-icon">üèÜ</div>
          <div class="checkpoint-info">
            <div class="checkpoint-number">2¬∞ Amico</div>
            <div class="checkpoint-prize">3 Mesi Gratis</div>
          </div>
          <span class="checkpoint-status">üîí</span>
        </div>
      </div>
    </div>

    <!-- Steps -->
    <div class="steps-section">
      <h2 class="section-title">Come Funziona</h2>

      <div class="step">
        <div class="step-header">
          <div class="step-number">1</div>
          <div class="step-title">Invita i Tuoi Amici</div>
        </div>
        <p class="step-description">Compila il form con i dati dei tuoi amici interessati ai corsi di inglese</p>
      </div>

      <div class="step">
        <div class="step-header">
          <div class="step-number">2</div>
          <div class="step-title">I Tuoi Amici Si Iscrivono</div>
        </div>
        <p class="step-description">Il nostro team li contatter√† per presentare l'offerta e aiutarli ad iscriversi</p>
      </div>

      <div class="step">
        <div class="step-header">
          <div class="step-number">3</div>
          <div class="step-title">Ricevi i Tuoi Premi</div>
        </div>
        <p class="step-description">1 amico iscritto = Trolley | 2 amici iscritti = Trolley + 3 mesi gratis!</p>
      </div>
    </div>

    <!-- CTA -->
    <div class="cta-section">
      <h2 class="cta-title">Inizia Ora!</h2>
      <p class="cta-subtitle">Puoi invitare fino a 2 amici contemporaneamente</p>
      <button class="cta-button" onclick="openModal()">Invita i Tuoi Amici üöÄ</button>
    </div>

    <!-- Requirements -->
    <div class="requirements">
      <h3 class="requirements-title">üìã Requisiti</h3>
      <div class="requirements-grid">
        <div class="requirement-item">
          <div class="requirement-icon">üìö</div>
          <div class="requirement-text">Min. 4 livelli</div>
        </div>
        <div class="requirement-item">
          <div class="requirement-icon">üë•</div>
          <div class="requirement-text">Nuovi studenti</div>
        </div>
        <div class="requirement-item">
          <div class="requirement-icon">‚è∞</div>
          <div class="requirement-text">Valido Febbraio 2026</div>
        </div>
      </div>
    </div>

    <!-- Share -->
    <div class="share-section">
      <h3 class="share-title">Condividi l'Opportunit√†</h3>
      <p class="share-text">Invia il link ai tuoi amici!</p>
      <div class="share-buttons">
        <button class="share-btn whatsapp" onclick="shareWhatsApp()"><span>üì±</span>WhatsApp</button>
        <button class="share-btn instagram" onclick="shareInstagram()"><span>üì∑</span>Instagram</button>
        <button class="share-btn tiktok" onclick="shareTikTok()"><span>üéµ</span>TikTok</button>
        <button class="share-btn copy" onclick="copyLink()"><span>üîó</span>Copia Link</button>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p class="footer-text">
        * La data di fine per Febbraio/Maggio verr√† comunicata internamente<br>
        e poi estesa su gentile richiesta degli studenti<br><br>
        ¬© 2026 Wall Street English. Tutti i diritti riservati.
      </p>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <div class="modal-header">
        <button class="close-btn" onclick="closeModal()" aria-label="Chiudi">√ó</button>
        <h2 class="modal-title">Invita i Tuoi Amici</h2>
        <p class="modal-subtitle">Compila il form per iniziare</p>
      </div>

      <!-- FORM -->
      <form id="referralForm" action="https://formsubmit.co/catania@wallstreet.it" method="POST">
        <!-- FormSubmit Configuration -->
        <input type="hidden" name="_subject" value="Nuovo Referral - Wall Street English Catania">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_template" value="table">
        <input type="text" name="_honey" style="display:none">

        <div class="form-body">

          <!-- Step 1: Student -->
          <div class="form-step active" id="step1">
            <h3 style="color:var(--wse-blue);font-size:18px;font-weight:900;margin-bottom:14px;">üìù I Tuoi Dati</h3>

            <div class="form-group">
              <label class="form-label">Nome e Cognome *</label>
              <input type="text" class="form-input" name="Studente_NomeCognome" id="studentName"
                     placeholder="Es. Mario Rossi" required>
            </div>

            <div class="info-box">
              <div class="info-box-title">üí° Nota</div>
              <div class="info-box-text">Inserisci solo Nome e Cognome. I contatti li raccogliamo solo per gli amici invitati.</div>
            </div>

            <button type="button" class="btn" onclick="goToStep2()">Avanti ‚Üí</button>
          </div>

          <!-- Step 2: Friends -->
          <div class="form-step" id="step2">
            <h3 style="color:var(--wse-blue);font-size:18px;font-weight:900;margin-bottom:14px;">üë• Dati dei Tuoi Amici</h3>

            <div id="friendsContainer">
              <!-- Friend 1 -->
              <div class="friend-entry" data-friend-number="1">
                <div class="friend-entry-header">
                  <span class="friend-entry-title">1¬∞ Amico (Obbligatorio)</span>
                </div>

                <div class="form-group">
                  <label class="form-label">Nome e Cognome *</label>
                  <input type="text" class="form-input" name="Amico_1_NomeCognome" required placeholder="Es. Giulia Bianchi">
                </div>

                <div class="form-group">
                  <label class="form-label">Email *</label>
                  <input type="email" class="form-input" name="Amico_1_Email" required placeholder="giulia.bianchi@email.com">
                </div>

                <div class="form-group">
                  <label class="form-label">Telefono *</label>
                  <input type="tel" class="form-input" name="Amico_1_Telefono" required placeholder="+39 333 123 4567">
                </div>
              </div>
            </div>

            <button type="button" class="add-friend-btn" id="addFriendBtn" onclick="addSecondFriend()">
              <span style="font-size:20px;">+</span>
              Aggiungi 2¬∞ Amico (Ottieni 3 Mesi Gratis!)
            </button>

            <input type="hidden" name="Numero_Amici" id="friendCount" value="1">
            <input type="hidden" name="Programma" value="Referral Febbraio 2026">
            <input type="hidden" name="Data_Invio" id="timestamp">

            <div class="checkbox-wrapper">
              <input type="checkbox" class="checkbox-input" id="consent" name="Consenso_Contatto_Amici" value="SI" required>
              <label class="checkbox-label" for="consent">
                Confermo che i miei amici acconsentono ad essere contattati da Wall Street English.
              </label>
            </div>

            <div class="checkbox-wrapper">
              <input type="checkbox" class="checkbox-input" id="terms" name="Accettazione_Termini" value="SI" required>
              <label class="checkbox-label" for="terms">
                Accetto i termini del programma referral.
              </label>
            </div>

            <button type="submit" class="btn" id="submitBtn">Invia Referral üéâ</button>
            <button type="button" class="btn btn-secondary" onclick="goToStep1()">‚Üê Indietro</button>
          </div>

          <!-- Loading -->
          <div class="form-step" id="loadingStep">
            <div style="text-align:center;padding:34px 18px;">
              <div class="spinner"></div>
              <p style="color:var(--text-gray);margin-top:16px;font-weight:800;">Invio in corso...</p>
            </div>
          </div>

          <!-- Success -->
          <div class="form-step" id="successStep">
            <div class="success-screen">
              <div class="success-icon">‚úì</div>
              <h3 class="success-title">Referral inviato!</h3>
              <p class="success-text">Grazie per aver partecipato al programma referral.</p>

              <div class="success-rewards" id="successRewardsBox">
                <div class="success-rewards-title">üéÅ Premi attivabili</div>
                <div id="successRewardsList"></div>
              </div>

              <div class="info-box">
                <div class="info-box-title">üìû Prossimi passi</div>
                <div class="info-box-text">
                  1) Contatteremo i tuoi amici<br>
                  2) Quando si iscrivono, ricevi i premi<br>
                  3) Ti aggiorniamo internamente sullo stato
                </div>
              </div>

              <button type="button" class="btn" onclick="resetAndClose()">Fatto!</button>
            </div>
          </div>

        </div>
      </form>
    </div>
  </div>

  <script>
    const pageURL = window.location.href;
    const shareMessage = "üéØ Wall Street English - Porta amici e vinci! 1 amico = Trolley, 2 amici = 3 mesi gratis! Scopri di pi√π:";

    let friendCount = 1;
    let secondFriendAdded = false;

    function updateFriendCounter(){
      document.getElementById("friendCountDisplay").textContent = friendCount;
      document.getElementById("friendCount").value = String(friendCount);

      // checkpoint 1: sempre achieved (perch√© amico 1 c'√® sempre)
      document.getElementById("checkpoint1").classList.add("achieved");
      document.querySelector("#checkpoint1 .checkpoint-status").textContent = "‚úì";

      // checkpoint 2: solo se aggiungi amico 2
      if(friendCount >= 2){
        document.getElementById("checkpoint2").classList.add("achieved");
        document.querySelector("#checkpoint2 .checkpoint-status").textContent = "‚úì";
      }else{
        document.getElementById("checkpoint2").classList.remove("achieved");
        document.querySelector("#checkpoint2 .checkpoint-status").textContent = "üîí";
      }
    }

    function addSecondFriend(){
      if(secondFriendAdded) return;

      const friendHTML = `
        <div class="friend-entry" data-friend-number="2" id="friend2Entry">
          <div class="friend-entry-header">
            <span class="friend-entry-title">2¬∞ Amico (Premio: 3 Mesi Gratis!)</span>
            <button type="button" class="remove-friend-btn" onclick="removeSecondFriend()">Rimuovi</button>
          </div>

          <div class="form-group">
            <label class="form-label">Nome e Cognome *</label>
            <input type="text" class="form-input" name="Amico_2_NomeCognome" required placeholder="Es. Marco Verdi">
          </div>

          <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email" class="form-input" name="Amico_2_Email" required placeholder="marco.verdi@email.com">
          </div>

          <div class="form-group">
            <label class="form-label">Telefono *</label>
            <input type="tel" class="form-input" name="Amico_2_Telefono" required placeholder="+39 333 987 6543">
          </div>
        </div>
      `;

      document.getElementById("friendsContainer").insertAdjacentHTML("beforeend", friendHTML);
      document.getElementById("addFriendBtn").style.display = "none";

      friendCount = 2;
      secondFriendAdded = true;
      updateFriendCounter();
    }

    function removeSecondFriend(){
      const el = document.getElementById("friend2Entry");
      if(el) el.remove();
      document.getElementById("addFriendBtn").style.display = "flex";

      friendCount = 1;
      secondFriendAdded = false;
      updateFriendCounter();
    }

    function openModal(){
      document.getElementById("modal").classList.add("active");
      document.getElementById("modal").setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
    }

    function closeModal(){
      document.getElementById("modal").classList.remove("active");
      document.getElementById("modal").setAttribute("aria-hidden","true");
      document.body.style.overflow = "auto";
    }

    function goToStep2(){
      const studentName = document.getElementById("studentName").value.trim();
      if(!studentName){
        alert("‚ö†Ô∏è Inserisci Nome e Cognome!");
        return;
      }
      document.getElementById("step1").classList.remove("active");
      document.getElementById("step2").classList.add("active");
    }

    function goToStep1(){
      document.getElementById("step2").classList.remove("active");
      document.getElementById("step1").classList.add("active");
    }

    function showLoading(){
      document.getElementById("step2").classList.remove("active");
      document.getElementById("loadingStep").classList.add("active");
    }

    function showSuccess(){
      document.getElementById("loadingStep").classList.remove("active");
      document.getElementById("successStep").classList.add("active");
    }

    function buildRewardsList(){
      const rewardsList = document.getElementById("successRewardsList");
      if(friendCount === 1){
        rewardsList.innerHTML = `
          <div class="success-reward-item">
            <span class="success-reward-icon">üß≥</span>
            <span class="success-reward-text">Trolley Esclusivo Wall Street English</span>
          </div>
        `;
      }else{
        rewardsList.innerHTML = `
          <div class="success-reward-item">
            <span class="success-reward-icon">üß≥</span>
            <span class="success-reward-text">Trolley Esclusivo Wall Street English</span>
          </div>
          <div class="success-reward-item">
            <span class="success-reward-icon">üèÜ</span>
            <span class="success-reward-text">3 Mesi di Corso Completamente Gratis</span>
          </div>
        `;
      }
    }

    function resetForm(){
      const form = document.getElementById("referralForm");
      form.reset();

      document.getElementById("successStep").classList.remove("active");
      document.getElementById("loadingStep").classList.remove("active");
      document.getElementById("step2").classList.remove("active");
      document.getElementById("step1").classList.add("active");

      if(secondFriendAdded) removeSecondFriend();
      friendCount = 1;
      secondFriendAdded = false;
      updateFriendCounter();
    }

    function resetAndClose(){
      resetForm();
      closeModal();
    }

    // Form submit (no redirect)
    document.getElementById("referralForm").addEventListener("submit", async function(e){
      e.preventDefault();

      // timestamp
      document.getElementById("timestamp").value = new Date().toLocaleString("it-IT");

      // premi in base al numero amici inseriti
      buildRewardsList();

      // loading
      showLoading();

      // invio (no-cors per evitare problemi CORS su GitHub Pages)
      try{
        const formData = new FormData(this);
        await fetch(this.action, {
          method: "POST",
          body: formData,
          mode: "no-cors"
        });

        // Mostra success anche se non possiamo leggere la response (no-cors)
        setTimeout(showSuccess, 700);
      }catch(err){
        alert("‚ö†Ô∏è Errore durante l'invio. Riprova.");
        // torna allo step 2
        document.getElementById("loadingStep").classList.remove("active");
        document.getElementById("step2").classList.add("active");
      }
    });

    // Share
    function shareWhatsApp(){
      const text = encodeURIComponent(shareMessage + " " + pageURL);
      window.open("https://wa.me/?text=" + text, "_blank");
    }

    function shareInstagram(){
      alert("üì∑ Copia il link e condividilo nelle tue Stories Instagram!\n\n" + pageURL);
      copyToClipboard(pageURL);
    }

    function shareTikTok(){
      alert("üéµ Copia il link e condividilo su TikTok!\n\n" + pageURL);
      copyToClipboard(pageURL);
    }

    function copyLink(){
      copyToClipboard(pageURL);
      alert("‚úì Link copiato! Incollalo dove preferisci.");
    }

    function copyToClipboard(text){
      const textarea = document.createElement("textarea");
      textarea.value = text;
      textarea.style.position = "fixed";
      textarea.style.opacity = "0";
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand("copy");
      document.body.removeChild(textarea);
    }

    // Chiudi modal clic fuori
    document.getElementById("modal").addEventListener("click", function(e){
      if(e.target === this) closeModal();
    });

    // init
    updateFriendCounter();
  </script>
</body>
</html>
